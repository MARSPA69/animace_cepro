<!doctype html>
<html lang="en">
  <!--begin::Head-->
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>AdminLTE v4 | Dashboard</title>
    <!--begin::Accessibility Meta Tags-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="color-scheme" content="light dark" />
    <meta name="theme-color" content="#007bff" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#1a1a1a" media="(prefers-color-scheme: dark)" />
    <!--end::Accessibility Meta Tags-->
    <!--begin::Primary Meta Tags-->
    <meta name="title" content="AdminLTE v4 | Dashboard" />
    <meta name="author" content="ColorlibHQ" />
    <meta
      name="description"
      content="AdminLTE is a Free Bootstrap 5 Admin Dashboard, 30 example pages using Vanilla JS. Fully accessible with WCAG 2.1 AA compliance."
    />
    <meta
      name="keywords"
      content="bootstrap 5, bootstrap, bootstrap 5 admin dashboard, bootstrap 5 dashboard, bootstrap 5 charts, bootstrap 5 calendar, bootstrap 5 datepicker, bootstrap 5 tables, bootstrap 5 datatable, vanilla js datatable, colorlibhq, colorlibhq dashboard, colorlibhq admin dashboard, accessible admin panel, WCAG compliant"
    />
    <!--end::Primary Meta Tags-->
    <!--begin::Accessibility Features-->
    <!-- Skip links will be dynamically added by accessibility.js -->
    <meta name="supported-color-schemes" content="light dark" />
    <link rel="stylesheet" href="./css/adminlte.css" />
    <!--end::Accessibility Features-->
    <!--begin::Fonts-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css"
      integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q="
      crossorigin="anonymous"
      media="print"
      onload="this.media='all'"
    />
    <!-- Google Fonts - Inter for modern UI -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tabler Icons - Removed due to MIME type issues -->
    <!--end::Fonts-->
    <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.11.0/styles/overlayscrollbars.min.css"
      crossorigin="anonymous"
    />
    <!--end::Third Party Plugin(OverlayScrollbars)-->
    <!--begin::Third Party Plugin(Bootstrap Icons)-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
      crossorigin="anonymous"
    />
    <!-- Modern UI Styling -->
    <style>
      /* Import Inter font for modern UI */
      * {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }

      /* Dark Dashboard Background */
      body {
        background-color: #1a1a1a !important;
        color: #ffffff !important;
      }

      .app-wrapper {
        background-color: #1a1a1a !important;
      }

      .app-main {
        background-color: #1a1a1a !important;
      }

      .card {
        background-color: #2d2d2d !important;
        border: 1px solid #404040 !important;
        color: #ffffff !important;
      }

      .card-header {
        background-color: #333333 !important;
        border-bottom: 1px solid #404040 !important;
        color: #ffffff !important;
      }

      .card-title {
        color: #ffffff !important;
      }

      .card-body {
        background-color: #2d2d2d !important;
        color: #ffffff !important;
      }

      /* Draggable Cards */
      .draggable-card {
        cursor: move;
        transition: all 0.2s ease;
        position: relative;
      }

      .draggable-card:hover {
        box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
        transform: translateY(-2px);
      }

      .draggable-header {
        cursor: move;
        user-select: none;
        background: linear-gradient(135deg, #333333 0%, #2d2d2d 100%) !important;
        border-bottom: 1px solid #404040 !important;
        min-height: 60px;
        padding: 12px 16px;
      }

      .draggable-header:hover {
        background: linear-gradient(135deg, #404040 0%, #333333 100%) !important;
      }

      .draggable-header .card-title {
        font-size: 18px;
        font-weight: 600;
        color: #ffffff !important;
      }

      /* Collapsible Functionality */
      .card.collapsed .card-body {
        display: none !important;
      }

      .card.collapsed {
        transition: all 0.3s ease;
        min-height: 60px;
        max-height: 60px;
        overflow: hidden;
      }

      .card.collapsed .draggable-header {
        min-height: 60px;
        border-radius: 12px 12px 0 0;
      }

      .collapse-toggle {
        background: rgba(255, 255, 255, 0.1) !important;
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 6px !important;
        color: #ffffff !important;
        transition: all 0.2s ease !important;
        width: 32px !important;
        height: 32px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 0 !important;
      }

      .collapse-toggle:hover {
        background: rgba(255, 255, 255, 0.2) !important;
        border-color: rgba(255, 255, 255, 0.3) !important;
        transform: scale(1.05) !important;
      }

      .collapse-toggle i {
        font-size: 14px !important;
        transition: all 0.2s ease !important;
      }

      /* Dragging State */
      .draggable-card.dragging {
        opacity: 0.8;
        transform: rotate(2deg);
        z-index: 1000;
        box-shadow: 0 8px 20px rgba(0,0,0,0.4) !important;
      }

      /* Drop Zone Highlight */
      .connectedSortable.drag-over {
        background: rgba(37, 99, 235, 0.1);
        border: 2px dashed #2563eb;
        border-radius: 8px;
      }

      /* Flexible Layout for Collapsed Boxes */
      .connectedSortable {
        display: flex;
        flex-direction: column;
        gap: 16px;
        min-height: 200px;
      }

      .card.collapsed {
        flex-shrink: 0;
        margin-bottom: 0 !important;
      }

      .card:not(.collapsed) {
        flex: 1;
      }

      /* Global Button Styles - uiverse.io inspired */
      .btn {
        font-family: 'Inter', sans-serif;
        border-radius: 12px;
        padding: 8px 16px;
        font-weight: 500;
        transition: all 0.2s ease-in-out;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        border: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        text-decoration: none;
        user-select: none;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.25);
      }

      .btn:active {
        transform: translateY(0);
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      }

      /* Button Color Variants */
      .btn-run, .btn-speedup, .btn-slowdown {
        background: #2563eb;
        color: white;
      }
      .btn-run:hover, .btn-speedup:hover, .btn-slowdown:hover {
        background: #1d4ed8;
      }

      .btn-stop {
        background: #ef4444;
        color: white;
      }
      .btn-stop:hover {
        background: #dc2626;
      }

      .btn-pause {
        background: #f97316;
        color: white;
      }
      .btn-pause:hover {
        background: #ea580c;
      }

      .btn-secondary {
        background: #6b7280;
        color: white;
      }
      .btn-secondary:hover {
        background: #4b5563;
      }

      /* Info Panels */
      .info-panel, .cross-panel {
        position: absolute;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 12px;
        padding: 12px;
        font-family: 'Inter', sans-serif;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        resize: both;
        overflow: auto;
        z-index: 1001;
        transition: all 0.2s ease-in-out;
      }

      .info-panel:hover, .cross-panel:hover {
        box-shadow: 0 6px 16px rgba(0,0,0,0.2);
      }



      /* Modern Control Panel - Draggable */
      #controls {
        position: absolute !important;
        bottom: 20px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.05);
        padding: 16px !important;
        display: flex;
        gap: 12px;
        align-items: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: move;
        z-index: 1001 !important;
        user-select: none;
      }

      #controls:hover {
        transform: translateX(-50%) translateY(-2px) !important;
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15), 0 4px 12px rgba(0, 0, 0, 0.08);
      }

      #controls.dragging {
        transform: translateX(-50%) rotate(2deg) !important;
        opacity: 0.8;
        z-index: 2000 !important;
      }

      /* Modern Button Styles */
      .btn-modern {
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 20px;
        border: none;
        border-radius: 12px;
        font-weight: 500;
        font-size: 14px;
        line-height: 1;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
        min-width: 100px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .btn-modern::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s;
      }

      .btn-modern:hover::before {
        left: 100%;
      }

      .btn-modern:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
      }

      .btn-modern:active {
        transform: translateY(0);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      /* Button Color Variants */
      .btn-modern-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-modern-success {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
      }

      .btn-modern-warning {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }

      .btn-modern-danger {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        color: white;
      }

      .btn-modern-secondary {
        background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        color: #333;
      }

      /* Modern Info Panels */
      .info-panel-modern {
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.05);
        padding: 20px !important;
        font-size: 14px;
        line-height: 1.5;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .info-panel-modern:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15), 0 4px 12px rgba(0, 0, 0, 0.08);
      }

      .info-panel-modern h3,
      .info-panel-modern strong {
        color: #1a202c;
        font-weight: 600;
        margin-bottom: 12px;
        font-size: 16px;
      }

      .info-panel-modern .info-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      }

      .info-panel-modern .info-item:last-child {
        border-bottom: none;
      }

      .info-panel-modern .info-label {
        font-weight: 500;
        color: #4a5568;
      }

      .info-panel-modern .info-value {
        font-weight: 600;
        color: #2d3748;
      }

      /* Ball Info Panel - Updated Design */
      #ballInfoPanel {
        background: rgba(255, 255, 255, 0.9) !important;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        padding: 0 !important;
        font-size: 14px;
        line-height: 1.5;
        transition: all 0.2s ease-in-out;
        cursor: move;
        position: absolute !important;
        z-index: 1001 !important;
        min-width: 280px;
        min-height: 120px;
        max-width: 500px;
        max-height: 400px;
        overflow: hidden;
        user-select: none;
        font-family: 'Inter', sans-serif;
      }

      #ballInfoPanel:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15), 0 4px 12px rgba(0, 0, 0, 0.08);
      }

      /* Panel Header */
      #ballInfoPanel .panel-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 12px 16px;
        border-radius: 16px 16px 0 0;
        font-weight: 600;
        font-size: 16px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: move;
        user-select: none;
      }

      #ballInfoPanel .panel-header .panel-title {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      #ballInfoPanel .panel-header .panel-controls {
        display: flex;
        gap: 4px;
      }

      #ballInfoPanel .panel-header .control-btn {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        border: none;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        transition: all 0.2s ease;
      }

      #ballInfoPanel .panel-header .control-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.1);
      }

      /* Panel Content */
      #ballInfoPanel .panel-content {
        padding: 16px;
        max-height: 300px;
        overflow-y: auto;
        font-family: 'Inter', sans-serif;
      }

      #ballInfoPanel .panel-content::-webkit-scrollbar {
        width: 6px;
      }

      #ballInfoPanel .panel-content::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 3px;
      }

      #ballInfoPanel .panel-content::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 3px;
      }

      #ballInfoPanel .panel-content::-webkit-scrollbar-thumb:hover {
        background: rgba(0, 0, 0, 0.3);
      }

      /* Info Items */
      #ballInfoPanel .info-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        font-size: 13px;
      }

      #ballInfoPanel .info-item:last-child {
        border-bottom: none;
      }

      #ballInfoPanel .info-label {
        font-weight: 500;
        color: #4a5568;
        flex: 1;
      }

      #ballInfoPanel .info-value {
        font-weight: 600;
        color: #2d3748;
        text-align: right;
        flex: 1;
      }

      /* Status Badges */
      #ballInfoPanel .status-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      #ballInfoPanel .status-badge.green {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
      }

      #ballInfoPanel .status-badge.red {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        color: white;
      }

      #ballInfoPanel .status-badge.yellow {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }

      /* Resize Handle */
      #ballInfoPanel .resize-handle {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 20px;
        height: 20px;
        background: linear-gradient(-45deg, transparent 30%, rgba(0, 0, 0, 0.1) 30%, rgba(0, 0, 0, 0.1) 70%, transparent 70%);
        cursor: nw-resize;
        border-radius: 0 0 16px 0;
      }

      #ballInfoPanel .resize-handle:hover {
        background: linear-gradient(-45deg, transparent 30%, rgba(0, 0, 0, 0.2) 30%, rgba(0, 0, 0, 0.2) 70%, transparent 70%);
      }

      /* Dragging State */
      #ballInfoPanel.dragging {
        opacity: 0.8;
        transform: rotate(2deg);
        z-index: 2000 !important;
      }

      /* Resizing State */
      #ballInfoPanel.resizing {
        user-select: none;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        #ballInfoPanel {
          min-width: 250px;
          max-width: 90vw;
        }
        
        #ballInfoPanel .panel-content {
          padding: 12px;
          font-size: 12px;
        }
        
        #ballInfoPanel .info-item {
          flex-direction: column;
          align-items: flex-start;
          gap: 2px;
        }
        
        #ballInfoPanel .info-value {
          text-align: left;
        }
      }

      /* Cross Log Panel */
      .leaflet-bar {
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 16px !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.05) !important;
        padding: 16px !important;
        font-family: 'Inter', sans-serif;
        font-size: 13px;
        line-height: 1.4;
      }

      /* Incident Panel */
      #infoPanel {
        position: absolute;
        top: 80px;
        left: 20px;
        z-index: 1500;
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.05);
        padding: 20px !important;
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        line-height: 1.5;
        max-width: 320px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      #infoPanel:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15), 0 4px 12px rgba(0, 0, 0, 0.08);
      }

      #infoPanel strong {
        color: #1a202c;
        font-weight: 600;
        margin-bottom: 12px;
        font-size: 16px;
        display: block;
      }

      #infoPanel button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 8px;
        padding: 8px 16px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      #infoPanel button:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      /* Map Controls */
      #map-controls {
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 2px 8px rgba(0, 0, 0, 0.05);
        padding: 16px !important;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      #map-controls button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 12px;
        padding: 12px 20px;
        font-weight: 500;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      #map-controls button:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
      }

      #map-controls button:active {
        transform: translateY(0);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        #controls {
          flex-wrap: wrap;
          gap: 8px;
          padding: 12px !important;
        }
        
        .btn-modern {
          min-width: 80px;
          padding: 10px 16px;
          font-size: 13px;
        }
        
        .info-panel-modern,
        #ballInfoPanel,
        #infoPanel {
          padding: 16px !important;
          font-size: 13px;
        }
      }

      /* Animation for smooth transitions */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .info-panel-modern,
      #ballInfoPanel,
      #infoPanel,
      #controls {
        animation: fadeInUp 0.3s ease-out;
      }
    </style>
    <!--end::Third Party Plugin(Bootstrap Icons)-->
    <!--begin::Required Plugin(AdminLTE)-->
    <!-- Leaflet CSS (nutné pro správné vykreslení dlaždic) -->
    <link
     rel="stylesheet"
     href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
     integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" 
     crossorigin="anonymous"
    />

    <!--end::Required Plugin(AdminLTE)-->
    <!-- apexcharts -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css"
      integrity="sha256-4MX+61mt9NVvvuPjUWdUdyfZfxSB1/Rf9WtqRHgG5S0="
      crossorigin="anonymous"
    />
    <!-- jsvectormap -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/jsvectormap@1.5.3/dist/css/jsvectormap.min.css"
      integrity="sha256-+uGLJmmTKOqBr+2E6KDYs/NRsHxSkONXFHUL0fy2O/4="
      crossorigin="anonymous"
    />
  <!--end::jsVectorMap-->
  </head>
  <!--begin::Body-->
  <body class="layout-fixed sidebar-expand-lg sidebar-open bg-body-tertiary">
    <!--begin::App Wrapper-->
    <div class="app-wrapper">
      <!--begin::Header-->
      <nav class="app-header navbar navbar-expand bg-body">
        <!--begin::Container-->
        <div class="container-fluid">

<div id="incident-details" style="padding:10px;">
  <div id="incident-login-list" style="display:none; margin-bottom:1em;">
    <strong>LogIn události:</strong>
    <ul id="login-list" style="padding-left: 1em;"></ul>
  </div>
  <div id="incident-logout-list" style="display:none; margin-bottom:1em;">
    <strong>LogOut události:</strong>
    <ul id="logout-list" style="padding-left: 1em;"></ul>
  </div>
  <div id="incident-duration-list" style="display:none; margin-bottom:1em;">
    <strong>Trvání incidentů:</strong>
    <ul id="duration-list" style="padding-left: 1em;"></ul>
  </div>
</div>

          <!--begin::Start Navbar Links-->
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" data-lte-toggle="sidebar" href="#" role="button">
                <i class="bi bi-list"></i>
              </a>
            </li>
            <li class="nav-item d-none d-md-block"><a href="#" class="nav-link">Home</a></li>
            <li class="nav-item d-none d-md-block"><a href="#" class="nav-link">Contact</a></li>
          </ul>
          <!--end::Start Navbar Links-->
          <!--begin::End Navbar Links-->
          <ul class="navbar-nav ms-auto">
            <!--begin::Navbar Search-->
            <li class="nav-item">
              <a class="nav-link" data-widget="navbar-search" href="#" role="button">
                <i class="bi bi-search"></i>
              </a>
            </li>
            <!--end::Navbar Search-->
            <!--begin::Messages Dropdown Menu-->
            <li class="nav-item dropdown">
              <a class="nav-link" data-bs-toggle="dropdown" href="#">
                <i class="bi bi-chat-text"></i>
                <span class="navbar-badge badge text-bg-danger">3</span>
              </a>
              <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
                <a href="#" class="dropdown-item">
                  <!--begin::Message-->
                  <div class="d-flex">
                    <div class="flex-shrink-0">
                      <img
                        src="./assets/img/user1-128x128.jpg"
                        alt="User Avatar"
                        class="img-size-50 rounded-circle me-3"
                      />
                    </div>
                    <div class="flex-grow-1">
                      <h3 class="dropdown-item-title">
                        Brad Diesel
                        <span class="float-end fs-7 text-danger"
                          ><i class="bi bi-star-fill"></i
                        ></span>
                      </h3>
                      <p class="fs-7">Call me whenever you can...</p>
                      <p class="fs-7 text-secondary">
                        <i class="bi bi-clock-fill me-1"></i> 4 Hours Ago
                      </p>
                    </div>
                  </div>
                  <!--end::Message-->
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item">
                  <!--begin::Message-->
                  <div class="d-flex">
                    <div class="flex-shrink-0">
                      <img
                        src="./assets/img/user8-128x128.jpg"
                        alt="User Avatar"
                        class="img-size-50 rounded-circle me-3"
                      />
                    </div>
                    <div class="flex-grow-1">
                      <h3 class="dropdown-item-title">
                        John Pierce
                        <span class="float-end fs-7 text-secondary">
                          <i class="bi bi-star-fill"></i>
                        </span>
                      </h3>
                      <p class="fs-7">I got your message bro</p>
                      <p class="fs-7 text-secondary">
                        <i class="bi bi-clock-fill me-1"></i> 4 Hours Ago
                      </p>
                    </div>
                  </div>
                  <!--end::Message-->
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item">
                  <!--begin::Message-->
                  <div class="d-flex">
                    <div class="flex-shrink-0">
                      <img
                        src="./assets/img/user3-128x128.jpg"
                        alt="User Avatar"
                        class="img-size-50 rounded-circle me-3"
                      />
                    </div>
                    <div class="flex-grow-1">
                      <h3 class="dropdown-item-title">
                        Nora Silvester
                        <span class="float-end fs-7 text-warning">
                          <i class="bi bi-star-fill"></i>
                        </span>
                      </h3>
                      <p class="fs-7">The subject goes here</p>
                      <p class="fs-7 text-secondary">
                        <i class="bi bi-clock-fill me-1"></i> 4 Hours Ago
                      </p>
                    </div>
                  </div>
                  <!--end::Message-->
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item dropdown-footer">See All Messages</a>
              </div>
            </li>
            <!--end::Messages Dropdown Menu-->
            <!--begin::Notifications Dropdown Menu-->
            <li class="nav-item dropdown">
              <a class="nav-link" data-bs-toggle="dropdown" href="#">
                <i class="bi bi-bell-fill"></i>
                <span class="navbar-badge badge text-bg-warning">15</span>
              </a>
              <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
                <span class="dropdown-item dropdown-header">15 Notifications</span>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item">
                  <i class="bi bi-envelope me-2"></i> 4 new messages
                  <span class="float-end text-secondary fs-7">3 mins</span>
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item">
                  <i class="bi bi-people-fill me-2"></i> 8 friend requests
                  <span class="float-end text-secondary fs-7">12 hours</span>
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item">
                  <i class="bi bi-file-earmark-fill me-2"></i> 3 new reports
                  <span class="float-end text-secondary fs-7">2 days</span>
                </a>
                <div class="dropdown-divider"></div>
                <a href="#" class="dropdown-item dropdown-footer"> See All Notifications </a>
              </div>
            </li>
            <!--end::Notifications Dropdown Menu-->
            <!--begin::Fullscreen Toggle-->
            <li class="nav-item">
              <a class="nav-link" href="#" data-lte-toggle="fullscreen">
                <i data-lte-icon="maximize" class="bi bi-arrows-fullscreen"></i>
                <i data-lte-icon="minimize" class="bi bi-fullscreen-exit" style="display: none"></i>
              </a>
            </li>
            <!--end::Fullscreen Toggle-->
            <!--begin::User Menu Dropdown-->
            <li class="nav-item dropdown user-menu">
              <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                <img
                  src="./assets/img/user2-160x160.jpg"
                  class="user-image rounded-circle shadow"
                  alt="User Image"
                />
                <span class="d-none d-md-inline">SHERLOG NG</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
                <!--begin::User Image-->
                <li class="user-header text-bg-primary">
                  <img
                    src="./assets/img/avatar3.png"
                    class="rounded-circle shadow"
                    alt="User Image"
                  />
                  <p>
                    SHERLOG NG - Web Developer
                    <small>Member since Nov. 2023</small>
                  </p>
                </li>
                <!--end::User Image-->
                <!--begin::Menu Body-->
                <li class="user-body">
                  <!--begin::Row-->
                  <div class="row">
                    <div class="col-4 text-center"><a href="#">Followers</a></div>
                    <div class="col-4 text-center"><a href="#">Sales</a></div>
                    <div class="col-4 text-center"><a href="#">Friends</a></div>
                  </div>
                  <!--end::Row-->
                </li>
                <!--end::Menu Body-->
                <!--begin::Menu Footer-->
                <li class="user-footer">
                  <a href="#" class="btn btn-default btn-flat">Profile</a>
                  <a href="#" class="btn btn-default btn-flat float-end">Sign out</a>
                </li>
                <!--end::Menu Footer-->
              </ul>
            </li>
            <!--end::User Menu Dropdown-->
          </ul>
          <!--end::End Navbar Links-->
        </div>
        <!--end::Container-->
      </nav>
      <!--end::Header-->
      <!--begin::Sidebar-->
      <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
        <!--begin::Sidebar Brand-->
        <div class="sidebar-brand">
          <!--begin::Brand Link-->
          <a href="./index.html" class="brand-link">
            <!--begin::Brand Image-->
            <img
              src="./assets/img/AdminLTELogo.png"
              alt="AdminLTE Logo"
              class="brand-image opacity-75 shadow"
            />
            <!--end::Brand Image-->
            <!--begin::Brand Text-->
            <span class="brand-text fw-light">AdminLTE 4</span>
            <!--end::Brand Text-->
          </a>
          <!--end::Brand Link-->
        </div>
        <!--end::Sidebar Brand-->
        <!--begin::Sidebar Wrapper-->
        <div class="sidebar-wrapper">
          <nav class="mt-2">
            <!--begin::Sidebar Menu-->
            <ul
              class="nav sidebar-menu flex-column"
              data-lte-toggle="treeview"
              role="navigation"
              aria-label="Main navigation"
              data-accordion="false"
              id="navigation"
            >
              <li class="nav-item menu-open">
                <a href="#" class="nav-link active">
                  <i class="nav-icon bi bi-speedometer"></i>
                  <p>
                    ČEPRO areál 1
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                 </a>
                 <ul class="nav nav-treeview">
                   <li class="nav-item">
                     <a href="./index.html" class="nav-link active">
                       <i class="nav-icon bi bi-circle"></i>
                       <p>Monitoring LIVE</p>
                     </a>
                    </li>
                    <li class="nav-item">
                      <a href="#" class="nav-link">
                       <i class="nav-icon bi bi-calendar3"></i>
                        <p>
                          Výběr dne
                          <i class="nav-arrow bi bi-chevron-right"></i>
                        </p>
                       </a>
                       <ul class="nav nav-treeview">
                         <li class="nav-item">
                           <a href="#" class="nav-link" onclick="loadDay(1)">
                             <i class="nav-icon bi bi-circle"></i><p>4. 6. 2025</p>
                           </a>
                          </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(2)">
                            <i class="nav-icon bi bi-circle"></i><p>30. 4. 2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(3)">
                            <i class="nav-icon bi bi-circle"></i><p>29. 4. 2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(4)">
                            <i class="nav-icon bi bi-circle"></i><p>16. 4. 2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(5)">
                            <i class="nav-icon bi bi-circle"></i><p>10. 4. 2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(6)">
                            <i class="nav-icon bi bi-circle"></i><p>FBM4. 6.  2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(7)">
                            <i class="nav-icon bi bi-circle"></i><p>FBM30. 4. 2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(8)">
                            <i class="nav-icon bi bi-circle"></i><p>FBM29. 4. 2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(9)">
                            <i class="nav-icon bi bi-circle"></i><p>FBM16. 4. 2025</p>
                          </a>
                         </li>
                          <li class="nav-item">
                            <a href="#" class="nav-link" onclick="loadDay(10)">
                            <i class="nav-icon bi bi-circle"></i><p>FBM10. 4. 2025</p>
                          </a>
                         </li>

                     <li class="nav-item mt-3">
                       <div class="p-2" style="font-size:13px">
                         <label for="channelSelect" class="form-label mb-1" style="font-weight:600">
                           Animace:
                         </label>
                         <select id="channelSelect" class="form-select form-select-sm">
                           <option value="none">Žádná</option>
                           <option value="offlinegnss">OFFLINEGNSS</option>
                           <option value="mesh">MESH FIXED GPS</option>
                           <option value="both">Porovnání (obě)</option>
                         </select>

                         <div class="mt-2">
                           <label for="meshDistInput" class="form-label mb-1" style="font-weight:600">
                             Limit přiblížení&nbsp;(m):
                           </label>
                           <input id="meshDistInput"
                                  type="number"
                                  class="form-control form-control-sm"
                                  value="5" min="1" max="50" step="0.5">
                         </div>
                         <!-- volby pro kotvovou animaci -->
                         <div id="anchorOptions" class="mt-2" style="display:none">
                           <label for="anchorSrc" class="form-label mb-1">Režim zdroje:</label>
                           <select id="anchorSrc" class="form-select form-select-sm">
                             <option value="dataset">Replay dataset</option>
                             <option value="synthetic">Start-GPS&nbsp;+&nbsp;v&nbsp;const</option>
                           </select>

                           <div id="syntheticForm" class="mt-2" style="display:none">
                             <input id="startLat"  class="form-control form-control-sm mb-1"
                                    placeholder="Start LAT">
                             <input id="startLon"  class="form-control form-control-sm mb-1"
                                    placeholder="Start LON">
                             <input id="startSpeed" class="form-control form-control-sm mb-1"
                                    placeholder="Rychlost m/s" value="1.4">
                             <input id="timeLength" class="form-control form-control-sm mb-2"
                                    placeholder="Délka (s)" value="60">
                             <button id="btnRunSynthetic" class="btn-modern btn-modern-primary" style="width: 100%;">
                               <i class="bi bi-geo-alt"></i>
                               Spustit syntetickou trasu
                             </button>
                            </div>
                           </div>
                          </div>
                         </li>
                    </ul>
                   </li>
                   <li class="nav-item mt-3" id="offline-gnss-panel">
                     <div class="p-2" style="font-size:13px">
                       <label class="form-label mb-1" style="font-weight:600">
                         Offline GNSS
                       </label>

                       <div style="display:flex; gap:8px; flex-wrap:wrap;">
                         <button id="btn-offline-gnss" class="btn-modern btn-modern-primary" style="flex: 1; min-width: 140px;">
                           <i class="bi bi-play-circle"></i>
                           Spustit Offline GNSS
                         </button>
                         <button id="btn-save-fused-log" class="btn-modern btn-modern-secondary" style="flex: 1; min-width: 140px;">
                           <i class="bi bi-save"></i>
                           Uložit F_GPS.js
                         </button>
                        </div>

                        <small class="text-muted d-block mt-2">
                        </small>
                      </div>
                   </li>
                   <li class="nav-item">
                     <a href="#" class="nav-link" onclick="saveIncidents()">
                       <i class="nav-icon bi bi-save"></i>
                       <p>Uložit incidenty</p>
                     </a>
                   </li>
                   <li class="nav-item">
                     <a href="#" class="nav-link" onclick="resetInfoPanelPosition()">
                       <i class="nav-icon bi bi-arrow-repeat"></i>
                       <p>Obnovit pozici info panelu</p>
                     </a>
                    </li>
                    <li class="nav-item">
                      <a href="./index2.html" class="nav-link">
                        <i class="nav-icon bi bi-circle"></i>
                        <p>Analýza incidentů</p>
                      </a>
                     </li>
                     <li class="nav-item">
                       <a href="./index3.html" class="nav-link">
                         <i class="nav-icon bi bi-circle"></i>
                         <p>Forenzní analýza</p>
                       </a>
                      </li>
                      <!-- ✳️ Nově přidaný odkaz -->
                      <li class="nav-item">
                        <a href="./passportizace.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Pasportizace kotev</p>
                        </a>
                       </li>
                      </ul>
                     </li>
              <li class="nav-item">
                <a href="./generate/theme.html" class="nav-link">
                  <i class="nav-icon bi bi-palette"></i>
                  <p>Modelování</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-box-seam-fill"></i>
                  <p>
                    Widgets
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./widgets/small-box.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Small Box</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./widgets/info-box.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>info Box</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./widgets/cards.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Cards</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-clipboard-fill"></i>
                  <p>
                    Layout Options
                    <span class="nav-badge badge text-bg-secondary me-3">6</span>
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./layout/unfixed-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Default Sidebar</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/fixed-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Fixed Sidebar</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/fixed-header.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Fixed Header</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/fixed-footer.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Fixed Footer</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/fixed-complete.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Fixed Complete</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/layout-custom-area.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Layout <small>+ Custom Area </small></p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/sidebar-mini.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Sidebar Mini</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/collapsed-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Sidebar Mini <small>+ Collapsed</small></p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/logo-switch.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Sidebar Mini <small>+ Logo Switch</small></p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./layout/layout-rtl.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Layout RTL</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-tree-fill"></i>
                  <p>
                    UI Elements
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./UI/general.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>General</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./UI/icons.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Icons</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./UI/timeline.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Timeline</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-pencil-square"></i>
                  <p>
                    Forms
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./forms/general.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>General Elements</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-table"></i>
                  <p>
                    Reporting
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./tables/simple.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Simple Tables</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-header">EXAMPLES</li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-box-arrow-in-right"></i>
                  <p>
                    Auth
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-box-arrow-in-right"></i>
                      <p>
                        Version 1
                        <i class="nav-arrow bi bi-chevron-right"></i>
                      </p>
                    </a>
                    <ul class="nav nav-treeview">
                      <li class="nav-item">
                        <a href="./examples/login.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Login</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="./examples/register.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Register</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-box-arrow-in-right"></i>
                      <p>
                        Version 2
                        <i class="nav-arrow bi bi-chevron-right"></i>
                      </p>
                    </a>
                    <ul class="nav nav-treeview">
                      <li class="nav-item">
                        <a href="./examples/login-v2.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Login</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="./examples/register-v2.html" class="nav-link">
                          <i class="nav-icon bi bi-circle"></i>
                          <p>Register</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="nav-item">
                    <a href="./examples/lockscreen.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Lockscreen</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-header">DOCUMENTATIONS</li>
              <li class="nav-item">
                <a href="./docs/introduction.html" class="nav-link">
                  <i class="nav-icon bi bi-download"></i>
                  <p>Installation</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/layout.html" class="nav-link">
                  <i class="nav-icon bi bi-grip-horizontal"></i>
                  <p>Layout</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/color-mode.html" class="nav-link">
                  <i class="nav-icon bi bi-star-half"></i>
                  <p>Color Mode</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-ui-checks-grid"></i>
                  <p>
                    Components
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./docs/components/main-header.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Main Header</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="./docs/components/main-sidebar.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Main Sidebar</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-filetype-js"></i>
                  <p>
                    Javascript
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="./docs/javascript/treeview.html" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Treeview</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="./docs/browser-support.html" class="nav-link">
                  <i class="nav-icon bi bi-browser-edge"></i>
                  <p>Browser Support</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/how-to-contribute.html" class="nav-link">
                  <i class="nav-icon bi bi-hand-thumbs-up-fill"></i>
                  <p>How To Contribute</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link" id="nav-zonovani">
                  <i class="nav-icon bi bi-map"></i>
                  <p>Zonování</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./docs/license.html" class="nav-link">
                  <i class="nav-icon bi bi-patch-check-fill"></i>
                  <p>License</p>
                </a>
              </li>
              <li class="nav-header">MULTI LEVEL EXAMPLE</li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle-fill"></i>
                  <p>Level 1</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle-fill"></i>
                  <p>
                    Level 1
                    <i class="nav-arrow bi bi-chevron-right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Level 2</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>
                        Level 2
                        <i class="nav-arrow bi bi-chevron-right"></i>
                      </p>
                    </a>
                    <ul class="nav nav-treeview">
                      <li class="nav-item">
                        <a href="#" class="nav-link">
                          <i class="nav-icon bi bi-record-circle-fill"></i>
                          <p>Level 3</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="#" class="nav-link">
                          <i class="nav-icon bi bi-record-circle-fill"></i>
                          <p>Level 3</p>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a href="#" class="nav-link">
                          <i class="nav-icon bi bi-record-circle-fill"></i>
                          <p>Level 3</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      <i class="nav-icon bi bi-circle"></i>
                      <p>Level 2</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle-fill"></i>
                  <p>Level 1</p>
                </a>
              </li>
              <li class="nav-header">LABELS</li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle text-danger"></i>
                  <p class="text">Important</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle text-warning"></i>
                  <p>Warning</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">
                  <i class="nav-icon bi bi-circle text-info"></i>
                  <p>Informational</p>
                </a>
              </li>
            </ul>
            <!--end::Sidebar Menu-->
          </nav>
        </div>
        <!--end::Sidebar Wrapper-->
      </aside>
      <!--end::Sidebar-->
      <!--begin::App Main-->
      <main class="app-main">
        <!--begin::App Content Header-->
        <div class="app-content-header">
          <!--begin::Container-->
          <div class="container-fluid">
          <div id="incident-details" style="padding:10px;">
          <div id="incident-login-list" style="display:none; margin-bottom:1em;">
            <strong>LogIn události:</strong>
            <ul id="login-list" style="padding-left: 1em;"></ul>
           </div>
         <div id="incident-logout-list" style="display:none; margin-bottom:1em;">
           <strong>LogOut události:</strong>
           <ul id="logout-list" style="padding-left: 1em;"></ul>
         </div>
        <div id="incident-duration-list" style="display:none; margin-bottom:1em;">
          <strong>Trvání incidentů:</strong>
          <ul id="duration-list" style="padding-left: 1em;"></ul>
        </div>
       </div>
            <!--begin::Row-->
            <div class="row">
              <div class="col-sm-6"><h3 class="mb-0">Dashboard</h3></div>
              <div class="col-sm-6">
                <ol class="breadcrumb float-sm-end">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Dashboard</li>
                </ol>
              </div>
            </div>
            <!--end::Row-->
          </div>
          <!--end::Container-->
        </div>
        <!--end::App Content Header-->
        <!--begin::App Content-->
        <div class="app-content">
          <!--begin::Container-->
          <div class="container-fluid">

<div id="incident-details" style="padding:10px;">
  <div id="incident-login-list" style="display:none; margin-bottom:1em;">
    <strong>LogIn události:</strong>
    <ul id="login-list" style="padding-left: 1em;"></ul>
  </div>
  <div id="incident-logout-list" style="display:none; margin-bottom:1em;">
    <strong>LogOut události:</strong>
    <ul id="logout-list" style="padding-left: 1em;"></ul>
  </div>
  <div id="incident-duration-list" style="display:none; margin-bottom:1em;">
    <strong>Trvání incidentů:</strong>
    <ul id="duration-list" style="padding-left: 1em;"></ul>
  </div>
</div>

            <!--begin::Row-->
            <div class="row">
              <!--begin::Col-->
              <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 1-->
                <div class="small-box text-bg-primary" id="incident-summary-box">
                  <div class="inner">
                    <h3 id="incident-summary-count">0</h3>
                    <p  id="incident-summary-label">Incident Log</p>
                    <ul id="incident-summary-list" style="max-height:120px; overflow-y:auto; padding-left:1em; margin-top:0.5em;">
                    </ul>
                  </div>
                  <svg
                    class="small-box-icon"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                  >
                    <path
                      d="M2.25 2.25a.75.75 0 000 1.5h1.386c.17 0 .318.114.362.278l2.558 9.592a3.752 3.752 0 00-2.806 3.63c0 .414.336.75.75.75h15.75a.75.75 0 000-1.5H5.378A2.25 2.25 0 017.5 15h11.218a.75.75 0 00.674-.421 60.358 60.358 0 002.96-7.228.75.75 0 00-.525-.965A60.864 60.864 0 005.68 4.509l-.232-.867A1.875 1.875 0 003.636 2.25H2.25zM3.75 20.25a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM16.5 20.25a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z"
                    ></path>
                  </svg>
                  <a
                    href="#"
                    class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover"
                  >
                    More info <i class="bi bi-link-45deg"></i>
                  </a>
                </div>
                <!--end::Small Box Widget 1-->
              </div>
              <!--end::Col-->
              <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 2-->
                <div class="small-box text-bg-success">
                  <div class="inner">
                    <h3>53<sup class="fs-5">%</sup></h3>
                    <p>Bounce Rate</p>
                  </div>
                  <svg
                    class="small-box-icon"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                  >
                    <path
                      d="M18.375 2.25c-1.035 0-1.875.84-1.875 1.875v15.75c0 1.035.84 1.875 1.875 1.875h.75c1.035 0 1.875-.84 1.875-1.875V4.125c0-1.036-.84-1.875-1.875-1.875h-.75zM9.75 8.625c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-.75a1.875 1.875 0 01-1.875-1.875V8.625zM3 13.125c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v6.75c0 1.035-.84 1.875-1.875 1.875h-.75A1.875 1.875 0 013 19.875v-6.75z"
                    ></path>
                  </svg>
                  <a
                    href="#"
                    class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover"
                  >
                    More info <i class="bi bi-link-45deg"></i>
                  </a>
                </div>
                <!--end::Small Box Widget 2-->
              </div>
              <!--end::Col-->
              <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 3-->
                <div class="small-box text-bg-warning">
                  <div class="inner">
                    <h3>44</h3>
                    <p>User Registrations</p>
                  </div>
                  <svg
                    class="small-box-icon"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                  >
                    <path
                      d="M6.25 6.375a4.125 4.125 0 118.25 0 4.125 4.125 0 01-8.25 0zM3.25 19.125a7.125 7.125 0 0114.25 0v.003l-.001.119a.75.75 0 01-.363.63 13.067 13.067 0 01-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 01-.364-.63l-.001-.122zM19.75 7.5a.75.75 0 00-1.5 0v2.25H16a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H22a.75.75 0 000-1.5h-2.25V7.5z"
                    ></path>
                  </svg>
                  <a
                    href="#"
                    class="small-box-footer link-dark link-underline-opacity-0 link-underline-opacity-50-hover"
                  >
                    More info <i class="bi bi-link-45deg"></i>
                  </a>
                </div>
                <!--end::Small Box Widget 3-->
              </div>
              <!--end::Col-->
              <div class="col-lg-3 col-6">
                <!--begin::Small Box Widget 4-->
                <div class="small-box text-bg-danger">
                  <div class="inner">
                    <h3>65</h3>
                    <p>Unique Visitors</p>
                  </div>
                  <svg
                    class="small-box-icon"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true"
                  >
                    <path
                      clip-rule="evenodd"
                      fill-rule="evenodd"
                      d="M2.25 13.5a8.25 8.25 0 018.25-8.25.75.75 0 01.75.75v6.75H18a.75.75 0 01.75.75 8.25 8.25 0 01-16.5 0z"
                    ></path>
                    <path
                      clip-rule="evenodd"
                      fill-rule="evenodd"
                      d="M12.75 3a.75.75 0 01.75-.75 8.25 8.25 0 018.25 8.25.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75V3z"
                    ></path>
                  </svg>
                  <a
                    href="#"
                    class="small-box-footer link-light link-underline-opacity-0 link-underline-opacity-50-hover"
                  >
                    More info <i class="bi bi-link-45deg"></i>
                  </a>
                </div>
                <!--end::Small Box Widget 4-->
              </div>
              <!--end::Col-->
            </div>
            <!--end::Row-->
	    <div class="row">
              <div class="col-12">
                <div class="card">
                  <div class="card-header">
                    <h3 class="card-title">Zonování – monitoring</h3>
                  </div>
                  <div id="map-wrapper" class="card-body" style="position:relative; padding:0;">
                    <div id="leafletMap" style="width:100%; height:100%; min-height:400px;"></div>
                    <div id="map-controls" style="
                      position: absolute;
                      bottom: 10px;
                      right: 10px;
                      z-index: 2001;
                      display: flex;
                      flex-direction: column;
                      gap: 6px;
                    ">
                      <button id="exportLogBtn" class="btn btn-secondary">
                        <i class="bi bi-download"></i>
                        Exportovat log
                      </button>
                      <button id="btn-fullscreen" class="btn btn-secondary" title="Zobrazit mapu na celou obrazovku">
                        <i class="bi bi-fullscreen"></i>
                        Celá obrazovka
                      </button>
                      <button id="btn-restore" class="btn btn-secondary" style="display:none;" title="Zmenšit mapu">
                        <i class="bi bi-fullscreen-exit"></i>
                        Zmenšit
                      </button>
                  </div>
                  <ul id="log-list" style="padding-left:1em;"></ul>
                   <div id="controls" class="draggable-panel">
                     <button id="startBtn" class="btn btn-run">
                       <i class="bi bi-play-fill"></i>
                       RUN
                     </button>
                     <button id="pauseBtn" class="btn btn-pause">
                       <i class="bi bi-pause-fill"></i>
                       PAUSE
                     </button>
                     <button id="stopBtn" class="btn btn-stop">
                       <i class="bi bi-stop-fill"></i>
                       STOP
                     </button>
                     <button id="fasterBtn" class="btn btn-speedup">
                       <i class="bi bi-fast-forward-fill"></i>
                       Zrychlit
                     </button>
                     <button id="slowerBtn" class="btn btn-slowdown">
                       <i class="bi bi-rewind-fill"></i>
                       Zpomalit
                     </button>
                   </div>
                  </div>
                </div>
              </div>
            </div>
            <!--end::Row-->
            <!--begin::Row-->
            <div class="row">
              <!-- 7/12 široký sloupec s grafem -->
              <div class="col-lg-7 connectedSortable">
               <div class="card mb-4 draggable-card" data-card-id="incidents-overview">
                <div class="card-header draggable-header" style="display: flex; justify-content: center; align-items: center; position: relative;">
                 <h3 class="card-title" style="margin: 0;">Přehled incidentů</h3>
                 <div class="card-tools" style="position: absolute; right: 16px;">
                  <button id="loadIncidentsBtn" class="btn btn-sm btn-outline-primary">
                  Aktualizovat
                  </button>
                 </div>
                 <button type="button" class="btn btn-tool collapse-toggle" data-card-id="incidents-overview" style="position: absolute; left: 16px;">
                    <i class="bi bi-plus-lg expand-icon"></i>
                    <i class="bi bi-dash-lg collapse-icon" style="display: none;"></i>
                  </button>
                </div>
                <div class="card-body">
                  <div id="revenue-chart" style="height:350px;"></div>
                  <input type="file" id="logFileInput" accept=".json" style="display:none;" />
                 </div>
                </div>
               </div>
               <!-- 5/12 široký sloupec s obrázkem -->
               <div class="col-lg-5 connectedSortable">
                <div class="card bg-dark text-white border-dark mb-4 draggable-card" data-card-id="map-segments">
                 <div class="card-header border-0 draggable-header" style="display: flex; justify-content: center; align-items: center; position: relative;">
                   <h3 class="card-title" style="margin: 0;">Mapa segmentů a kotev</h3>
                   <button type="button" class="btn btn-tool collapse-toggle" data-card-id="map-segments" style="position: absolute; left: 16px;">
                       <i class="bi bi-plus-lg expand-icon"></i>
                       <i class="bi bi-dash-lg collapse-icon" style="display: none;"></i>
                      </button>
                    </div>
                    <div class="card-body text-center">
                     <img
                       src="./assets/img/mapa_kotvy.png"
                       alt="Mapa kotev v areálu"
                       style="max-width:100%; height:auto; border-radius:8px; box-shadow:0 0 6px rgba(0,0,0,0.2);"
                      />
                    </div>
                   </div>
                  </div>
                 </div>
                 <!--end::Row-->
              </div>
                  </div>
                </div>
              </div>
              <!-- /.Start col -->
            </div>
            <!-- /.row (main row) -->
          </div>
          <!--end::Container-->
        </div>
        <!--end::App Content-->
      </main>
      <!--end::App Main-->
      <!--begin::Footer-->
      <footer class="app-footer">
        <!--begin::To the end-->
        <div class="float-end d-none d-sm-inline">Anything you want</div>
        <!--end::To the end-->
        <!--begin::Copyright-->
        <strong>
          Copyright &copy; 2014-2025&nbsp;
          <a href="https://adminlte.io" class="text-decoration-none">AdminLTE.io</a>.
        </strong>
        All rights reserved.
        <!--end::Copyright-->
      </footer>
      <!--end::Footer-->
    </div>
    <!--end::App Wrapper-->
    <!--begin::Script-->
    <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <script
      src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.11.0/browser/overlayscrollbars.browser.es6.min.js"
      crossorigin="anonymous"
    ></script>
    <!--end::Third Party Plugin(OverlayScrollbars)-->
    <!--begin::Required Plugin(popperjs for Bootstrap 5)-->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      crossorigin="anonymous"
    ></script>
    <!--end::Required Plugin(popperjs for Bootstrap 5)-->
    <!--begin::Required Plugin(Bootstrap 5)-->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js"
      crossorigin="anonymous"
    ></script>
    <!--end::Required Plugin(Bootstrap 5)-->
    <!--begin::Required Plugin(AdminLTE)-->
    <script src="./js/adminlte.js"></script>
    <!-- Leaflet JS (mapové podklady) -->
    <script
     src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
     integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
     crossorigin="anonymous"
    ></script>
    <!--end::Leaflet-->
    <!-- Turf JS (geometrické výpočty) -->
    <script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>
    <!--end::Turf-->
    <!--begin::ApexCharts-->
    <script   
        src="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.min.js"
        integrity="sha256-+vh8GkaU7C9/wbSLIcwq82tQ2wTf44aOHA8HlBMwRI8="
        crossorigin="anonymous"
    ></script>
    <!--end::ApexCharts-->
    <!-- Můj vlastní kod renderer.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="./FIXED_GPS_MESH.js?v=20250801"></script>
    <script src="./MESH_FIXEDGPS_ANCHFOOTPRINT.js"></script>
    <script src="./BASIC_TABLE_04062025.js?v=20250801"></script>
    <script src="./MIDAXIS.js"></script>
    <script src="./ANCHORID_TO_COMPASSANGLE.js?v=20250818"></script>
    <script src="./ANCHOR.js"></script>
    <script src="./FUSED_GPS.js"></script>
    <script src="./ANCHORFOOTPRINT.js"></script>
    <script src="./renderer.js"></script>
    <!--end::Můj kod-->

    <!-- Funkce showAnchor -->
    <script>
      function showAnchor(id) {
        document.getElementById("anchorNum").textContent = id;
        document.getElementById("anchorImg").src = `assets/img/Kotva${id}.jpg`;
        document.getElementById("anchorDesc").textContent =
          `Ofocené údaje o instalaci kotvy č. ${id}`;
        $('#anchorModal').modal('show');
      }
    </script>
    <!--begin::OverlayScrollbars Configure-->
    <script>
      const SELECTOR_SIDEBAR_WRAPPER = '.sidebar-wrapper';
      const Default = {
        scrollbarTheme: 'os-theme-light',
        scrollbarAutoHide: 'leave',
        scrollbarClickScroll: true,
      };
      document.addEventListener('DOMContentLoaded', function () {
        const sidebarWrapper = document.querySelector(SELECTOR_SIDEBAR_WRAPPER);
        if (sidebarWrapper && OverlayScrollbarsGlobal?.OverlayScrollbars !== undefined) {
          OverlayScrollbarsGlobal.OverlayScrollbars(sidebarWrapper, {
            scrollbars: {
              theme: Default.scrollbarTheme,
              autoHide: Default.scrollbarAutoHide,
              clickScroll: Default.scrollbarClickScroll,
            },
          });
        }
      });
    </script>
    <!--end::OverlayScrollbars Configure-->
    <!-- OPTIONAL SCRIPTS -->
    <!-- sortablejs -->
    <script
      src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"
      crossorigin="anonymous"
    ></script>
    <!-- sortablejs -->
    <script>
      new Sortable(document.querySelector('.connectedSortable'), {
        group: 'shared',
        handle: '.card-header',
      });
      const cardHeaders = document.querySelectorAll('.connectedSortable .card-header');
      cardHeaders.forEach((cardHeader) => {
        cardHeader.style.cursor = 'move';
      });
    
     // jsvectormap - podmíněné načtení
     const mapElement = document.querySelector('#world-map');
     if (mapElement) {
       new jsVectorMap({
        selector: '#world-map',
        map: 'world'
       });
      }
     
      // Sparkline charts
      const option_sparkline1 = {
        series: [
          {
            data: [1000, 1200, 920, 927, 931, 1027, 819, 930, 1021],
          },
        ],
        chart: {
          type: 'area',
          height: 50,
          sparkline: {
            enabled: true,
          },
        },
        stroke: {
          curve: 'straight',
        },
        fill: {
          opacity: 0.3,
        },
        yaxis: {
          min: 0,
        },
        colors: ['#DCE6EC'],
      };

      const sparkline1 = new ApexCharts(document.querySelector('#sparkline-1'), option_sparkline1);
      sparkline1.render();

      const option_sparkline2 = {
        series: [
          {
            data: [515, 519, 520, 522, 652, 810, 370, 627, 319, 630, 921],
          },
        ],
        chart: {
          type: 'area',
          height: 50,
          sparkline: {
            enabled: true,
          },
        },
        stroke: {
          curve: 'straight',
        },
        fill: {
          opacity: 0.3,
        },
        yaxis: {
          min: 0,
        },
        colors: ['#DCE6EC'],
      };

      const sparkline2 = new ApexCharts(document.querySelector('#sparkline-2'), option_sparkline2);
      sparkline2.render();

      const option_sparkline3 = {
        series: [
          {
            data: [15, 19, 20, 22, 33, 27, 31, 27, 19, 30, 21],
          },
        ],
        chart: {
          type: 'area',
          height: 50,
          sparkline: {
            enabled: true,
          },
        },
        stroke: {
          curve: 'straight',
        },
        fill: {
          opacity: 0.3,
        },
        yaxis: {
          min: 0,
        },
        colors: ['#DCE6EC'],
      };

      const sparkline3 = new ApexCharts(document.querySelector('#sparkline-3'), option_sparkline3);
      sparkline3.render();
    </script>
    <!--end::Script-->
  
  <script>
  // Funkce pro přetahování panelů
  function makeDraggable(el) {
    el.addEventListener("mousedown", function(e) {
      if (e.target.tagName === "BUTTON" || e.target.closest("button")) return;
      const shiftX = e.clientX - el.getBoundingClientRect().left;
      const shiftY = e.clientY - el.getBoundingClientRect().top;

      function moveAt(pageX, pageY) {
        el.style.left = pageX - shiftX + "px";
        el.style.top = pageY - shiftY + "px";
      }

      function onMouseMove(e) {
        moveAt(e.pageX, e.pageY);
      }

      document.addEventListener("mousemove", onMouseMove);

      el.addEventListener("mouseup", function() {
        document.removeEventListener("mousemove", onMouseMove);
      }, { once: true });
    });
    el.ondragstart = () => false;
  }
  <!-- Drag & drop kód (pokud ho máte) -->
      document.querySelectorAll(".draggable-panel").forEach(makeDraggable);



      // Dashboard Cards - Collapsible and Draggable Functionality
      
      // Wait for DOM to be fully loaded
      document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded, initializing dashboard functionality...');
        
        // Collapsible functionality
        const toggleButtons = document.querySelectorAll('.collapse-toggle');
        console.log('Found toggle buttons:', toggleButtons.length);
        
        toggleButtons.forEach(button => {
          button.addEventListener('click', (e) => {
            e.stopPropagation();
            e.preventDefault();
            
            const cardId = button.getAttribute('data-card-id');
            const card = document.querySelector(`[data-card-id="${cardId}"]`);
            const expandIcon = button.querySelector('.expand-icon');
            const collapseIcon = button.querySelector('.collapse-icon');
            
            console.log('Toggle clicked for card:', cardId); // Debug log
            
            if (card && expandIcon && collapseIcon) {
              if (card.classList.contains('collapsed')) {
                // Expand
                card.classList.remove('collapsed');
                expandIcon.style.display = 'none';
                collapseIcon.style.display = 'inline';
                console.log('Expanded card:', cardId);
              } else {
                // Collapse
                card.classList.add('collapsed');
                expandIcon.style.display = 'inline';
                collapseIcon.style.display = 'none';
                console.log('Collapsed card:', cardId);
              }
            }
          });
        });
      });

        // Enhanced Draggable functionality
        let draggedElement = null;
        let draggedFromColumn = null;
        let isDragging = false;

        const draggableCards = document.querySelectorAll('.draggable-card');
        console.log('Found draggable cards:', draggableCards.length);
        
        draggableCards.forEach(card => {
          const header = card.querySelector('.draggable-header');
          
          header.addEventListener('mousedown', (e) => {
            // Don't start drag if clicking on buttons
            if (e.target.closest('button')) {
              console.log('Button clicked, not starting drag');
              return;
            }
            
            console.log('Starting drag for card:', card.getAttribute('data-card-id'));
            isDragging = false;
            draggedElement = card;
            draggedFromColumn = card.closest('.connectedSortable');
            
            // Add visual feedback immediately
            card.style.cursor = 'grabbing';
            
            e.preventDefault();
          });

          header.addEventListener('mousemove', (e) => {
            if (draggedElement === card && !isDragging) {
              console.log('Starting drag movement for card:', card.getAttribute('data-card-id'));
              isDragging = true;
              card.classList.add('dragging');
              
              // Create a ghost element for visual feedback
              const ghost = card.cloneNode(true);
              ghost.style.position = 'absolute';
              ghost.style.pointerEvents = 'none';
              ghost.style.opacity = '0.7';
              ghost.style.zIndex = '1000';
              ghost.style.transform = 'rotate(2deg)';
              document.body.appendChild(ghost);
              
              const rect = card.getBoundingClientRect();
              ghost.style.left = rect.left + 'px';
              ghost.style.top = rect.top + 'px';
              ghost.style.width = rect.width + 'px';
              ghost.style.height = rect.height + 'px';
            }
          });
        });

        // Handle mouse move for dragging
        document.addEventListener('mousemove', (e) => {
          if (!draggedElement || !isDragging) return;
          
          console.log('Mouse move during drag');
          
          const ghost = document.body.querySelector('.draggable-card[style*="position: absolute"]');
          if (ghost) {
            ghost.style.left = e.clientX - 50 + 'px';
            ghost.style.top = e.clientY - 20 + 'px';
          }
          
          // Check for drop zones
          const dropZones = document.querySelectorAll('.connectedSortable');
          dropZones.forEach(zone => {
            const rect = zone.getBoundingClientRect();
            if (e.clientX >= rect.left && e.clientX <= rect.right && 
                e.clientY >= rect.top && e.clientY <= rect.bottom) {
              zone.classList.add('drag-over');
            } else {
              zone.classList.remove('drag-over');
            }
          });
        });

        // Handle mouse up to complete drag
        document.addEventListener('mouseup', (e) => {
          if (!draggedElement) return;
          
          const dropZones = document.querySelectorAll('.connectedSortable');
          let droppedInZone = null;
          
          dropZones.forEach(zone => {
            const rect = zone.getBoundingClientRect();
            if (e.clientX >= rect.left && e.clientX <= rect.right && 
                e.clientY >= rect.top && e.clientY <= rect.bottom) {
              droppedInZone = zone;
            }
            zone.classList.remove('drag-over');
          });
          
          if (droppedInZone && droppedInZone !== draggedFromColumn) {
            // Move the card to the new column
            droppedInZone.appendChild(draggedElement);
          }
          
          // Clean up
          draggedElement.classList.remove('dragging');
          draggedElement.style.cursor = 'move';
          const ghost = document.body.querySelector('.draggable-card[style*="position: absolute"]');
          if (ghost) {
            ghost.remove();
          }
          
          draggedElement = null;
          draggedFromColumn = null;
          isDragging = false;
        
      }); // End of DOMContentLoaded

      // Enhanced control panel dragging
      const controls = document.getElementById('controls');
      let startX, startY, startLeft, startTop;

      controls?.addEventListener('mousedown', (e) => {
        if (e.target.tagName === 'BUTTON') return; // Don't drag when clicking buttons
        
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        startLeft = parseInt(window.getComputedStyle(controls).left, 10);
        startTop = parseInt(window.getComputedStyle(controls).top, 10);
        
        controls.classList.add('dragging');
        document.addEventListener('mousemove', handleControlDrag);
        document.addEventListener('mouseup', stopControlDrag);
        e.preventDefault();
      });

      function handleControlDrag(e) {
        if (!isDragging) return;
        
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        
        const newLeft = startLeft + deltaX;
        const newTop = startTop + deltaY;
        
        // Keep panel within viewport bounds
        const mapWrapper = document.getElementById('map-wrapper');
        const mapRect = mapWrapper.getBoundingClientRect();
        const panelRect = controls.getBoundingClientRect();
        
        const maxLeft = mapRect.width - panelRect.width;
        const maxTop = mapRect.height - panelRect.height;
        
        controls.style.left = Math.max(0, Math.min(newLeft, maxLeft)) + 'px';
        controls.style.top = Math.max(0, Math.min(newTop, maxTop)) + 'px';
        controls.style.bottom = 'auto';
        controls.style.transform = 'none';
      }

      function stopControlDrag() {
        isDragging = false;
        controls.classList.remove('dragging');
        document.removeEventListener('mousemove', handleControlDrag);
        document.removeEventListener('mouseup', stopControlDrag);
      }
   </script>
   <script>
/* TENHLE BLOK DEJ TĚSNĚ PŘED </body>  NEBO HO OBAĽ do DOMContentLoaded */
(function () {
  const wrapper    = document.getElementById('map-wrapper');
  const mapDiv     = document.getElementById('leafletMap');
  const btnFull    = document.getElementById('btn-fullscreen');
  const btnRestore = document.getElementById('btn-restore');

  if (!wrapper || !mapDiv || !btnFull || !btnRestore) {
    console.error('fullscreen-script: prvek nenalezen (wrapper/mapDiv/btnFull/btnRestore)');
    return;                  // ukončí, takže nedojde k .style na null
  }

  const original = {
    position: wrapper.style.position,
    top:      wrapper.style.top,
    left:     wrapper.style.left,
    width:    wrapper.style.width,
    height:   wrapper.style.height,
    zIndex:   wrapper.style.zIndex
  };

  btnFull.addEventListener('click', () => {
    Object.assign(wrapper.style, {
      position:'fixed', top:'0', left:'0',
      width:'100vw', height:'100vh', zIndex:'3000'
    });
    mapDiv.style.height = '100%';
    btnFull.style.display    = 'none';
    btnRestore.style.display = 'inline-block';
    setTimeout(() => window.leafletMap?.invalidateSize(), 300);
  });

  btnRestore.addEventListener('click', () => {
    Object.assign(wrapper.style, original);
    mapDiv.style.height = '400px';
    mapDiv.style.minHeight = '400px';
    btnRestore.style.display = 'none';
    btnFull.style.display    = 'inline-block';
    setTimeout(() => window.leafletMap?.invalidateSize(), 300);
  });
})();
</script>
</body>
</html>